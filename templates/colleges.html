<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>College Directory - NexEd</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, Cantarell, sans-serif;
        background: linear-gradient(135deg, #e8eef7 0%, #f5f7fa 100%);
        min-height: 100vh;
        color: #333;
      }

      .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 30px;
        padding: 20px 40px;
        background: white;
        border-radius: 15px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }

      .logo-section {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .logo {
        width: 40px;
        height: 40px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 1.2rem;
      }

      .logo img {
        width: 40px;
      }

      .logo-text {
        font-size: 32px; /* adjust size */
        font-weight: bold; /* bold for logo look */
        font-family: Arial, sans-serif;
      }

      .logo-text .nex {
        color: #197dbb; /* blue for Nex */
      }

      .logo-text .ed {
        color: #000000; /* black for Ed */
      }

      .user-info {
        display: flex;
        align-items: center;
        gap: 10px;
        color: #197dbb;
        font-weight: 600;
      }

      .user-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background: #197dbb;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 0.9rem;
      }

      .main-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 40px 20px;
      }

      .page-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: #3d52d5;
        margin-bottom: 30px;
        text-align: center;
      }

      .search-container {
        background: rgba(168, 188, 230, 0.3);
        border-radius: 25px;
        padding: 40px;
        margin-bottom: 40px;
        backdrop-filter: blur(10px);
      }

      .search-box {
        position: relative;
        margin-bottom: 30px;
      }

      .search-input {
        width: 100%;
        padding: 18px 60px 18px 50px;
        border: none;
        border-radius: 50px;
        font-size: 1.1rem;
        background: white;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        outline: none;
        transition: all 0.3s ease;
      }

      .search-input:focus {
        box-shadow: 0 8px 30px rgba(74, 103, 196, 0.2);
        transform: translateY(-2px);
      }

      .search-icon {
        position: absolute;
        left: 18px;
        top: 50%;
        transform: translateY(-50%);
        color: #999;
      }

      .search-btn {
        position: absolute;
        right: 8px;
        top: 50%;
        transform: translateY(-50%);
        background: #ebbb1b;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 25px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .search-btn:hover {
        background: #d4a617;
        transform: translateY(-50%) scale(1.05);
      }

      .filter-tabs {
        display: flex;
        gap: 20px;
        justify-content: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      .filter-tab {
        padding: 12px 30px;
        background: transparent;
        border: 2px solid #3d52d5;
        border-radius: 25px;
        color: #3d52d5;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1rem;
      }

      .filter-tab.active {
        background: #3d52d5;
        color: white;
        box-shadow: 0 4px 15px rgba(74, 103, 196, 0.3);
      }

      .filter-tab:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(74, 103, 196, 0.2);
      }

      .colleges-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 2rem;
        margin-top: 2rem;
      }

      .college-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 1.5rem;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        cursor: pointer;
        transition: all 0.3s;
        position: relative;
        overflow: hidden;
      }

      .college-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
      }

      .management-badge {
        position: absolute;
        top: 1rem;
        right: 1rem;
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 0.3rem 0.8rem;
        border-radius: 15px;
        font-size: 0.8rem;
        font-weight: 500;
      }

      .college-card.govt .management-badge {
        background: linear-gradient(135deg, #27ae60, #2ecc71);
      }

      .college-card.state .management-badge {
        background: linear-gradient(135deg, #3498db, #2980b9);
      }

      .college-card.central .management-badge {
        background: linear-gradient(135deg, #e74c3c, #c0392b);
      }

      .college-card.private .management-badge {
        background: linear-gradient(135deg, #f39c12, #e67e22);
      }

      .college-card.deemed .management-badge {
        background: linear-gradient(135deg, #9b59b6, #8e44ad);
      }
      .college-name {
        font-size: 1.2rem;
        font-weight: bold;
        color: #333;
        margin-bottom: 0.5rem;
        margin-top: 1.5rem;
        line-height: 1.3;
      }

      .college-location {
        color: #666;
        font-size: 0.9rem;
        margin-bottom: 1rem;
      }

      .college-details {
        margin: 1rem 0;
      }

      .detail-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0.5rem;
        padding: 0.3rem 0;
        border-bottom: 1px solid #f0f0f0;
      }

      .detail-label {
        color: #666;
        font-weight: 500;
        font-size: 0.9rem;
      }

      .detail-value {
        color: #333;
        font-size: 0.9rem;
        text-align: right;
        max-width: 60%;
      }

      .detail-value a {
        color: #667eea;
        text-decoration: none;
      }

      .detail-value a:hover {
        text-decoration: underline;
      }

      .view-more-btn {
        /* background: linear-gradient(135deg, #667eea, #764ba2); */
        background-color: #3d52d5;
        color: white;
        border: none;
        padding: 0.8rem 1.5rem;
        border-radius: 10px;
        cursor: pointer;
        font-size: 0.9rem;
        width: 100%;
        margin-top: 1rem;
        transition: all 0.3s;
      }

      .view-more-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .no-results {
        text-align: center;
        padding: 60px 20px;
        color: #666;
      }

      .no-results-icon {
        font-size: 4rem;
        margin-bottom: 20px;
        opacity: 0.5;
      }

      .error-container {
        text-align: center;
        padding: 60px 20px;
        color: #e74c3c;
      }

      .error-icon {
        font-size: 4rem;
        margin-bottom: 20px;
      }

      .management-badge {
        position: absolute;
        top: 20px;
        right: 20px;
        background: rgba(255, 255, 255, 0.2);
        color: white;
        padding: 6px 12px;
        border-radius: 15px;
        font-size: 0.85rem;
        font-weight: 600;
        backdrop-filter: blur(10px);
      }

      @media (max-width: 768px) {
        .header {
          padding: 15px 20px;
        }

        .main-container {
          padding: 20px 15px;
        }

        .page-title {
          font-size: 2rem;
        }

        .search-container {
          padding: 25px 20px;
        }

        .filter-tabs {
          flex-wrap: wrap;
          gap: 10px;
        }

        .filter-tab {
          padding: 10px 20px;
          font-size: 0.9rem;
        }

        .colleges-grid {
          grid-template-columns: 1fr;
          gap: 20px;
        }

        .college-card {
          padding: 25px;
        }

        .college-name {
          font-size: 1.5rem;
        }
      }

      .back-btn {
        background: transparent;
        border: 2px solid #3d52d5;
        color: #3d52d5;
        padding: 10px 20px;
        border-radius: 20px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-right: 15px;
      }

      .back-btn:hover {
        background: #3d52d5;
        color: white;
      }

      .search-suggestions {
        background: white;
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        margin-top: 10px;
        max-height: 200px;
        overflow-y: auto;
        display: none;
      }

      .suggestion-item {
        padding: 12px 20px;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      .suggestion-item:hover {
        background: #f8f9fa;
      }

      .suggestion-item:first-child {
        border-radius: 15px 15px 0 0;
      }

      .suggestion-item:last-child {
        border-radius: 0 0 15px 15px;
      }

      .results-counter {
        text-align: center;
        margin-bottom: 20px;
        color: #666;
        font-weight: 500;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <div class="logo-section">
        <div class="logo">
          <!-- <img src="./assets/logo final.png" alt="Logo" /> -->

          <img
            src="{{ url_for('static', filename='./assets/logo final.png') }}"
            alt=""
          />
        </div>
        <span class="logo-text">
          <span class="nex">Nex</span><span class="ed">Ed</span>
        </span>
      </div>

      <div class="user-info" onclick="goToProfile()">
        <div class="user-avatar" id="userAvatar">M</div>
        <span id="userName">User</span>
      </div>
    </div>

    <div class="main-container">
        <button class="back-btn" onclick="goBack()">← Back</button>
        <h1 class="page-title">College Directory</h1>

      <div class="search-container">
        <div class="search-box">
          <svg
            class="search-icon"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
          <input
            type="text"
            class="search-input"
            id="searchInput"
            placeholder="Enter District Name (e.g., Nicobars, Mumbai, Delhi)"
          />
          <button class="search-btn" onclick="searchColleges()">Search</button>
        </div>
        <div id="searchSuggestions" class="search-suggestions"></div>

        <div class="filter-tabs">
          <button
            class="filter-tab active"
            onclick="showNearbyColleges()"
            data-filter="nearby"
            id="nearbyBtn"
          >
            Nearby
          </button>
          <button
            class="filter-tab"
            onclick="filterColleges('government')"
            data-filter="government"
          >
            Government
          </button>
          <button
            class="filter-tab"
            onclick="filterColleges('private')"
            data-filter="private"
          >
            Private
          </button>
          <button
            class="filter-tab"
            onclick="filterColleges('state')"
            data-filter="state"
          >
            State
          </button>
          <button
            class="filter-tab"
            onclick="filterColleges('central')"
            data-filter="central"
          >
            Central
          </button>
        </div>
      </div>

      <div id="resultsInfo" class="results-info" style="display: none"></div>

      <div
        id="loadingContainer"
        class="loading-container"
        style="display: none"
      >
        <div class="loading-spinner"></div>
        <p>Loading colleges...</p>
      </div>

      <div id="errorContainer" class="error-container" style="display: none">
        <div class="error-icon">⚠️</div>
        <h3>Error Loading Data</h3>
        <p id="errorMessage">
          Unable to load college data. Please try again later.
        </p>
      </div>

      <div id="collegesGrid" class="colleges-grid">
        <!-- Colleges will be populated here -->
      </div>

      <div id="noResults" class="no-results" style="display: none">
        <div class="no-results-icon">🏫</div>
        <h3>No colleges found</h3>
        <p>Try searching for a different district or browse all colleges.</p>
      </div>
    </div>

    <script>
      // -------------------------------------------------------------------------------------------------------------------------------------------------
      let currentFilter = "all";
      let currentColleges = [];
      let allDistricts = [];
      let userCity = null;

      // Initialize page
      document.addEventListener("DOMContentLoaded", function () {
        console.log("Page loaded, initializing...");
        loadUserData();
        loadUserCity();
        loadAllDistricts();
        loadAllColleges();
        showNearbyColleges();

        // Add search functionality
        const searchInput = document.getElementById("searchInput");
        searchInput.addEventListener("input", debounce(handleSearchInput, 300));
        searchInput.addEventListener("focus", showSuggestions);
        searchInput.addEventListener("blur", hideSuggestions);
      });

      function loadUserCity() {
        const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));
        if (loggedInUser) {
          const users = JSON.parse(localStorage.getItem("users")) || [];
          const user = users.find((u) => u.email === loggedInUser.email);
          if (user && user.city) {
            userCity = user.city;
            console.log("User city loaded:", userCity);

            // Show nearby button only if user has city
            document.getElementById("nearbyBtn").style.display = "inline-block";
          } else {
            // Hide nearby button if no city
            document.getElementById("nearbyBtn").style.display = "none";
            console.log("No user city found, hiding nearby button");
          }
        }
      }

      async function loadAllDistricts() {
        try {
          console.log("Loading districts...");
          const response = await fetch("/api/districts");
          const data = await response.json();

          if (data.success) {
            allDistricts = data.districts;
            console.log(
              `Loaded ${allDistricts.length} districts:`,
              allDistricts
            );
          } else {
            console.error("Failed to load districts:", data.error);
          }
        } catch (error) {
          console.error("Error loading districts:", error);
        }
      }

      // async function loadAllColleges() {
      //     try {
      //         console.log('Loading all colleges...');
      //         showLoading();
      //         const response = await fetch('/api/search', {
      //             method: 'POST',
      //             headers: {
      //                 'Content-Type': 'application/json',
      //             },
      //             body: JSON.stringify({
      //                 query: '',
      //                 type: 'all'
      //             })
      //         });

      //         const data = await response.json();
      //         console.log('All colleges response:', data);
      //         hideLoading();

      //         if (data.success) {
      //             currentColleges = data.colleges;
      //             displayColleges(currentColleges);
      //             updateResultsInfo(`Showing ${data.total} colleges`);
      //         } else {
      //             showError(data.error || 'Failed to load colleges');
      //         }
      //     } catch (error) {
      //         hideLoading();
      //         showError('Network error. Please check your connection.');
      //         console.error('Error loading colleges:', error);
      //     }
      // }

      async function loadAllColleges() {
        try {
          console.log("Loading all colleges...");
          showLoading();
          const response = await fetch("/api/search", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              query: "",
              type: "all",
            }),
          });
        } catch (error) {
          hideLoading();
          showError("Network error. Please check your connection.");
          console.error("Error loading colleges:", error);
        }
      }

      async function searchColleges() {
        const query = document.getElementById("searchInput").value.trim();
        console.log("Searching for:", query);

        if (!query) {
          loadAllColleges();
          return;
        }

        try {
          showLoading();
          const response = await fetch("/api/search", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              query: query,
              type: "district",
            }),
          });

          const data = await response.json();
          console.log("Search response:", data);
          hideLoading();

          if (data.success) {
            currentColleges = data.colleges;

            // Apply current filter
            const filteredColleges = applyFilter(
              currentColleges,
              currentFilter
            );
            displayColleges(filteredColleges);

            if (data.matched_district) {
              updateResultsInfo(
                `Found ${data.total} colleges in <span class="matched-district">${data.matched_district}</span>`,
                true
              );
            } else {
              updateResultsInfo("No colleges found for the searched district");
            }
          } else {
            // Show no results instead of error for search failures
            showNoResults();
            updateResultsInfo("No colleges found for the searched district");
          }
        } catch (error) {
          hideLoading();
          showError("Network error. Please check your connection.");
          console.error("Error:", error);
        }
      }

      async function showNearbyColleges() {
        if (!userCity) {
          alert(
            "Please update your city in your profile to see nearby colleges."
          );
          return;
        }

        try {
          console.log("Searching nearby colleges for city:", userCity);
          showLoading();

          // Update active tab
          setActiveTab("nearby");

          const response = await fetch("/api/search", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              query: userCity,
              type: "district",
            }),
          });

          const data = await response.json();
          console.log("Nearby colleges response:", data);
          hideLoading();

          if (data.success && data.colleges.length > 0) {
            currentColleges = data.colleges;
            currentFilter = "nearby";
            displayColleges(currentColleges);

            if (data.matched_district) {
              updateResultsInfo(
                `Found ${data.total} colleges near <span class="matched-district">${data.matched_district}</span>`,
                true
              );
            } else {
              updateResultsInfo(`Showing ${data.total} nearby colleges`);
            }
          } else {
            showNoResults();
            updateResultsInfo(
              `No colleges found near ${userCity}. Try browsing all colleges.`
            );
          }
        } catch (error) {
          hideLoading();
          showError("Network error. Please check your connection.");
          console.error("Error loading nearby colleges:", error);
        }
      }

      function handleSearchInput() {
        const query = document.getElementById("searchInput").value.trim();
        if (query.length > 0) {
          updateSuggestions(query);
        } else {
          loadAllColleges();
        }
      }

      function updateSuggestions(query) {
        const suggestions = allDistricts
          .filter((district) =>
            district.toLowerCase().includes(query.toLowerCase())
          )
          .slice(0, 5);

        const suggestionsContainer =
          document.getElementById("searchSuggestions");

        if (suggestions.length > 0 && query.length > 0) {
          suggestionsContainer.innerHTML = suggestions
            .map(
              (district) =>
                `<div class="suggestion-item" onmousedown="selectSuggestion('${district}')">${district}</div>`
            )
            .join("");
          suggestionsContainer.style.display = "block";
        } else {
          suggestionsContainer.style.display = "none";
        }
      }

      function selectSuggestion(district) {
        document.getElementById("searchInput").value = district;
        document.getElementById("searchSuggestions").style.display = "none";
        searchColleges();
      }

      function showSuggestions() {
        const query = document.getElementById("searchInput").value.trim();
        if (query.length > 0) {
          updateSuggestions(query);
        }
      }

      function hideSuggestions() {
        setTimeout(() => {
          document.getElementById("searchSuggestions").style.display = "none";
        }, 200);
      }

      function filterColleges(filter) {
        if (filter === "nearby") {
          showNearbyColleges();
          return;
        }

        currentFilter = filter;
        setActiveTab(filter);

        // Apply filter
        const filteredColleges = applyFilter(currentColleges, filter);
        displayColleges(filteredColleges);
        updateResultsInfo(
          `Showing ${filteredColleges.length} colleges (${filter})`
        );
      }

      function setActiveTab(filter) {
        // Update active tab
        document.querySelectorAll(".filter-tab").forEach((tab) => {
          tab.classList.remove("active");
        });
        document
          .querySelector(`[data-filter="${filter}"]`)
          .classList.add("active");
      }

      function applyFilter(colleges, filter) {
        switch (filter) {
          case "government":
            return colleges.filter(
              (college) =>
                college.Management.toLowerCase().includes("government") ||
                college.Management.toLowerCase().includes("govt")
            );
          case "private":
            return colleges.filter((college) =>
              college.Management.toLowerCase().includes("private")
            );
          case "state":
            return colleges.filter((college) =>
              college.Management.toLowerCase().includes("state")
            );
          case "central":
            return colleges.filter((college) =>
              college.Management.toLowerCase().includes("central")
            );
          case "all":
          default:
            return colleges;
        }
      }

      function displayColleges(colleges) {
        const grid = document.getElementById("collegesGrid");
        const noResults = document.getElementById("noResults");
        const errorContainer = document.getElementById("errorContainer");

        // Hide error and no results initially
        errorContainer.style.display = "none";
        noResults.style.display = "none";

        if (colleges.length === 0) {
          grid.style.display = "none";
          noResults.style.display = "block";
          return;
        }

        grid.style.display = "grid";

        grid.innerHTML = colleges
          .map((college, index) => {
            const managementClass = getManagementClass(college.Management);
            const establishedYear = college["Year Of Establishment"] || "N/A";
            const website = college.Website || "#";
            const universityName =
              college["University Name"] || "Not Specified";

            return `
                    <div class="college-card ${managementClass}" onclick="viewCollegeDetails('${
              college["Aishe Code"]
            }')">
                        <div class="management-badge">${
                          college.Management
                        }</div>
                        <div class="college-name">${truncateText(
                          college.Name,
                          50
                        )}</div>
                        <div class="college-location">${college.District}, ${
              college.State
            }</div>
                        
                        <div class="college-details">
                            <div class="detail-item">
                                <span class="detail-label">Type:</span>
                                <span class="detail-value">${
                                  college["College Type"]
                                }</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Established:</span>
                                <span class="detail-value">${establishedYear}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Location:</span>
                                <span class="detail-value">${
                                  college.Location
                                }</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">University:</span>
                                <span class="detail-value">${truncateText(
                                  universityName,
                                  30
                                )}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">AISHE Code:</span>
                                <span class="detail-value">${
                                  college["Aishe Code"]
                                }</span>
                            </div>
                            ${
                              website !== "#"
                                ? `
                            <div class="detail-item">
                                <span class="detail-label">Website:</span>
                                <span class="detail-value"><a href="${website}" target="_blank" onclick="event.stopPropagation()">Visit</a></span>
                            </div>
                            `
                                : ""
                            }
                        </div>
                        
                        <button class="view-more-btn" onclick="event.stopPropagation(); viewCollegeDetails('${
                          college["Aishe Code"]
                        }')">
                            View More Details
                        </button>
                    </div>
                `;
          })
          .join("");

        // Add animation
        const cards = grid.querySelectorAll(".college-card");
        cards.forEach((card, index) => {
          card.style.opacity = "0";
          card.style.transform = "translateY(30px)";
          setTimeout(() => {
            card.style.transition = "all 0.6s ease";
            card.style.opacity = "1";
            card.style.transform = "translateY(0)";
          }, index * 50);
        });
      }

      function showNoResults() {
        document.getElementById("collegesGrid").style.display = "none";
        document.getElementById("errorContainer").style.display = "none";
        document.getElementById("noResults").style.display = "block";
      }

      function getManagementClass(management) {
        if (!management) return "private";

        const mgmt = management.toLowerCase();
        if (mgmt.includes("government") || mgmt.includes("govt")) return "govt";
        if (mgmt.includes("state")) return "state";
        if (mgmt.includes("central")) return "central";
        if (mgmt.includes("private")) return "private";
        if (mgmt.includes("deemed")) return "deemed";
        return "private";
      }

      function truncateText(text, maxLength) {
        if (!text) return "N/A";
        return text.length > maxLength
          ? text.substring(0, maxLength) + "..."
          : text;
      }

      async function viewCollegeDetails(aisheCode) {
        try {
          const response = await fetch(`/api/college/${aisheCode}`);
          const data = await response.json();

          if (data.success) {
            const college = data.college;
            const details = `
🏫 College: ${college.Name}

📍 Location: ${college.District}, ${college.State}
🏛️ Type: ${college["College Type"]}
🏢 Management: ${college.Management}
📅 Established: ${college["Year Of Establishment"] || "N/A"}
🎓 University: ${college["University Name"] || "Not Specified"}
🌐 Website: ${college.Website || "Not Available"}
📋 AISHE Code: ${college["Aishe Code"]}
🏙️ Location Type: ${college.Location}

University Details:
🆔 University AISHE Code: ${college["University Aishe Code"] || "N/A"}
🏛️ University Type: ${college["University Type"] || "N/A"}
                    `;

            alert(details);
          } else {
            alert("College details not found.");
          }
        } catch (error) {
          console.error("Error fetching college details:", error);
          alert("Error fetching college details.");
        }
      }

      function updateResultsInfo(message, isHtml = false) {
        const resultsInfo = document.getElementById("resultsInfo");
        if (isHtml) {
          resultsInfo.innerHTML = message;
        } else {
          resultsInfo.textContent = message;
        }
        resultsInfo.style.display = "block";
      }

      function showLoading() {
        document.getElementById("loadingContainer").style.display = "block";
        document.getElementById("collegesGrid").style.display = "none";
        document.getElementById("noResults").style.display = "none";
        document.getElementById("errorContainer").style.display = "none";
      }

      function hideLoading() {
        document.getElementById("loadingContainer").style.display = "none";
      }

      function showError(message) {
        document.getElementById("errorContainer").style.display = "block";
        document.getElementById("errorMessage").textContent = message;
        document.getElementById("collegesGrid").style.display = "none";
        document.getElementById("noResults").style.display = "none";
      }

      function goToProfile() {
        window.location.href = "/profile";
      }

      function goBack() {
        if (document.referrer && document.referrer !== window.location.href) {
          window.history.back();
        } else {
          window.location.href = "/";
        }
      }

      // Utility function for debouncing
      function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      }

      // Load user data from signup
      function loadUserData() {
        const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));
        if (loggedInUser) {
          const users = JSON.parse(localStorage.getItem("users")) || [];
          const user = users.find((u) => u.email === loggedInUser.email);
          if (user && user.name) {
            document.getElementById("userName").textContent = user.name;
            document.getElementById("userAvatar").textContent = user.name
              .charAt(0)
              .toUpperCase();
          }
        }
      }

      // Handle Enter key in search input
      document.addEventListener("keydown", function (event) {
        if (
          event.key === "Enter" &&
          document.activeElement === document.getElementById("searchInput")
        ) {
          searchColleges();
        }
      });

      //         function showNearby() {
      //     const nearbyBtn = document.getElementById('nearbyBtn');

      //     // Only proceed if the button has the active class
      //     if (nearbyBtn.classList.contains('active')) {
      //         // Your code here
      //         showNearbyColleges() ;
      //         // Add your logic for displaying nearby colleges
      //     }
      // }
    </script>
  </body>
</html>
